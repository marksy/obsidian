/*!
 * obsidian
 * dashboard type of thing
 * http://marksy.com
 * @author marksy
 * @version 0.1
 * Copyright 2015. MIT licensed.
 */
'use strict';
// Source: src/js/app.js
//app
(function() {
	var app = angular.module('app',
	[
		'ngRoute'
	])
	.config(['$routeProvider', '$locationProvider', '$httpProvider', function($routeProver, $locationProvider, $httpProvider){
		$routeProver
			.when('/home', {
				templateUrl: 'views/home.html',
				controller: 'HomeController'
			})
			.when('/weather', {
				templateUrl: 'views/weather.html',
				controller: 'WeatherController'
			})
			.when('/tfl', {
				templateUrl: 'views/tfl.html',
				controller: 'TFLController'
			})
			.when('/stocks', {
				templateUrl: 'views/stocks.html',
				controller: 'StocksController'
			})
			.when('/config', {
				templateUrl: 'views/config.html',
				controller: 'ConfigController'
			})
			.otherwise({redirectTo: '/home'});
	}]);
})();
// Source: src/js/base.js
function beerOClock(d,h,m) {
	var beer = new Date();
	
	beer.setDate(d);
	beer.setHours(h);
	beer.setMinutes(m);
	
	var today = new Date();
	var day = today.getDay();
	var hour = today.getHours();
	var minutes = today.getMinutes();
	
	var beerDay = beer.getDay();
	var beerHour = beer.getHours();
	var beerMinutes = beer.getMinutes();

	var daysTil = 0;
	 
	if (day === beerDay) {
		console.log((beerHour - hour) + 'hrs, ' + (60 - minutes) + 'mins until Beer O\'Clock');
		//return false
	}
	if (day <= (beerDay-1)) {
		daysTil = beerDay-day;
		console.log(daysTil + ' days, ' + (beerHour - hour) + 'hrs, ' + ((60 - minutes) + beerMinutes) + 'mins until Beer O\'Clock');
		//return false
	}
	else {
		daysTil = (day-beerDay) + beerDay;
		console.log(daysTil + ' days, ' + (beerHour - hour) + 'hrs, ' + (60 - minutes + beerMinutes) + 'mins until Beer O\'Clock');
	}

	
}

beerOClock(5,17,20);
// Source: src/js/config.js
//config settings


// clock

// twitter 

//weather
var weatherKey = '08c33162-6e48-4b98-bfe7-38ccaae9c53d';
var weatherUrl = 'http://datapoint.metoffice.gov.uk/public/data/val/wxfcs/all/json/3772?res=3hourly&key='+weatherKey;

var weatherCodes = {
	'0':	'Clear night',
	'1':	'Sunny day',
	'2':	'Partly cloudy (night)',
	'3':	'Partly cloudy (day)',
	'4':	'Not used',
	'5':	'Mist',
	'6':	'Fog',
	'7':	'Cloudy',
	'8':	'Overcast',
	'9':	'Light rain shower (night)',
	'10':	'Light rain shower (day)',
	'11':	'Drizzle',
	'12':	'Light rain',
	'13':	'Heavy rain shower (night)',
	'14':	'Heavy rain shower (day)',
	'15':	'Heavy rain',
	'16':	'Sleet shower (night)',
	'17':	'Sleet shower (day)',
	'18':	'Sleet',
	'19':	'Hail shower (night)',
	'20':	'Hail shower (day)',
	'21':	'Hail',
	'22':	'Light snow shower (night)',
	'23':	'Light snow shower (day)',
	'24':	'Light snow',
	'25':	'Heavy snow shower (night)',
	'26':	'Heavy snow shower (day)',
	'27':	'Heavy snow',
	'28':	'Thunder shower (night)',
	'29':	'Thunder shower (day)',
	'30':	'Thunder'
};
console.log(weatherCodes);


//tfl

//stocks GBP v NZD

//now playing/spotify/itunes

//staff

//jira


// Source: src/js/controllers.js
//controllers
(function(){
	var app = angular.module('app');
	
	app.controller('IndexController', ['$scope', '$rootScope', function($scope,$rootScope){
		$scope.root = $rootScope;
		$scope.dateTimeFormat = 'd MMM h:mm a';
		
		console.log('IndexController');
		
	}]);
	
	app.controller('HomeController', ['$scope', '$rootScope', function($scope,$rootScope){
		$scope.root = $rootScope;
		
		console.log('HomeController');
		
	}]);
	
	app.controller('WeatherController', ['$scope', '$rootScope', '$http', function($scope,$rootScope,$http){
		$scope.root = $rootScope;
		
		$scope.location = 'London';
		$scope.temp = '--';
		$scope.windspeed = '--';
		$scope.rain = '--';
		$scope.type = '--';
		
		$http.get(weatherUrl).success(function(data,status,headers,config){
			$scope.temp = data.SiteRep.DV.Location.Period[0].Rep[0].T;
			$scope.windspeed = data.SiteRep.DV.Location.Period[0].Rep[0].S;
			$scope.rain = data.SiteRep.DV.Location.Period[0].Rep[0].Pp;
			$scope.typeNo = data.SiteRep.DV.Location.Period[0].Rep[0].W;
			$scope.type = weatherCodes[$scope.typeNo];
		})
		.error(function(data,status,headers,config){
			console.log('error: ' + data,status,headers,config);
		});
		
		console.log('WeatherController');
		
	}]);
	
	app.controller('TFLController', ['$scope', '$rootScope', function($scope,$rootScope){
		$scope.root = $rootScope;
		
		console.log('TFLController');
		
	}]);
	
	app.controller('StocksController', ['$scope', '$rootScope', function($scope,$rootScope){
		$scope.root = $rootScope;
		
		console.log('StocksController');
		
	}]);
	
	app.controller('ConfigController', ['$scope', '$rootScope', function($scope,$rootScope){
		$scope.root = $rootScope;
		
		console.log('ConfigController');
		
	}]);
})(); 


// Source: src/js/directives.js
(function(){
	var app = angular.module('app');

	app.directive('myCurrentTime', function(dateFilter){
	    return function(scope, element, attrs){
	        var format;
        
	        scope.$watch(attrs.myCurrentTime, function(value) {
	            format = value;
	            updateTime();
	          });
        
	        function updateTime(){
	            var dt = dateFilter(new Date(), format);
	            element.text(dt);
	          }
        
	        function updateLater() {
	            setTimeout(function() {
	              updateTime(); 
	              updateLater(); 
	            }, 60000);
	          }
        
	        updateLater();
	      };
	  });
})(); 

// Source: src/js/filters.js
